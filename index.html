<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkyCast - Professional</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- CORE STYLES --- */
        :root { --bg-color: #0b0c15; --card-bg: #1c1d2e; --accent: #7b61ff; --text-main: #ffffff; --text-sec: #a0a0b0; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Nunito', sans-serif; }
        body { background-color: var(--bg-color); color: var(--text-main); display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        
        .app-container { 
            width: 100%; max-width: 420px; height: 100vh; /* Fixed height for scrolling inside */
            background: var(--bg-color); 
            padding: 0 20px; /* Remove top/bottom padding here */
            position: relative; 
            overflow-y: auto; /* Enable Scroll inside container */
            scrollbar-width: none; /* Hide scrollbar Firefox */
        }
        .app-container::-webkit-scrollbar { display: none; } /* Hide scrollbar Chrome/Safari */

        /* --- STICKY SEARCH BAR --- */
        .sticky-header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: var(--bg-color); /* Matches background to hide content behind it */
            padding-top: 20px;
            padding-bottom: 10px;
        }

        .search-bar { 
            display: flex; background: var(--card-bg); border-radius: 15px; padding: 10px 15px; 
            align-items: center; border: 1px solid rgba(255,255,255,0.1); 
            box-shadow: 0 4px 15px rgba(0,0,0,0.3); /* Shadow for floating effect */
        }
        .search-bar input { background: transparent; border: none; color: white; flex: 1; font-size: 16px; outline: none; margin-left: 10px; }
        .search-btn { background: var(--accent); border: none; width: 40px; height: 40px; border-radius: 12px; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; }

        .suggestions-list { position: absolute; top: 75px; left: 0; width: 100%; background: #232438; border-radius: 15px; list-style: none; z-index: 1000; box-shadow: 0 10px 30px rgba(0,0,0,0.8); max-height: 250px; overflow-y: auto; display: none; border: 1px solid rgba(123, 97, 255, 0.2); }
        .suggestions-list li { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.05); cursor: pointer; display: flex; justify-content: space-between; }
        .suggestions-list li:hover { background: var(--accent); }

        /* --- WEATHER CONTENT --- */
        .content-area { margin-top: 10px; } /* Space after header */

        .main-card { background: linear-gradient(145deg, #1c1d2e, #2a2c45); border-radius: 30px; padding: 25px; position: relative; display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .weather-text h1 { font-size: 60px; font-weight: 800; line-height: 1; margin: 10px 0; }
        .weather-text h2 { font-size: 22px; }
        .weather-text p { color: var(--accent); font-size: 16px; text-transform: capitalize; }
        .feels-like { color: var(--text-sec); font-size: 14px; margin-top: 5px; font-weight: 600; }
        .weather-3d-icon { width: 140px; height: 140px; object-fit: contain; filter: drop-shadow(0 0 25px rgba(123, 97, 255, 0.2)); animation: float 4s ease-in-out infinite; }

        .details-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 25px; }
        .detail-box { background: var(--card-bg); padding: 20px 15px; border-radius: 25px; text-align: center; }
        .detail-box i { font-size: 22px; color: var(--accent); margin-bottom: 8px; }
        .detail-box span { display: block; font-size: 16px; font-weight: 700; }
        .detail-box small { color: var(--text-sec); font-size: 12px; }

        .ad-slot { width: 100%; min-height: 90px; background: #141526; border: 2px dashed #333; border-radius: 20px; display: flex; justify-content: center; align-items: center; margin: 25px 0; color: #666; font-weight: 700; letter-spacing: 1px; }

        .daily-row { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid rgba(255,255,255,0.08); }
        .daily-left { display: flex; align-items: center; }
        .daily-icon { width: 45px; height: 45px; object-fit: contain; margin-right: 15px; }
        .day-name { font-weight: 700; font-size: 16px; }
        .day-phrase { color: var(--text-sec); font-size: 12px; margin-top: 2px; }
        .day-temp { font-weight: 700; font-size: 16px; }

        /* --- NEW FOOTER STYLES --- */
        .app-footer {
            text-align: center;
            padding: 30px 0;
            border-top: 1px solid rgba(255,255,255,0.05);
            margin-top: 20px;
            color: var(--text-sec);
        }
        .app-footer p { font-size: 14px; margin-bottom: 10px; }
        .app-footer b { color: var(--accent); }
        .footer-links { font-size: 12px; opacity: 0.7; }
        .footer-links span { cursor: pointer; transition: 0.2s; }
        .footer-links span:hover { color: white; text-decoration: underline; }

        @keyframes float { 0% { transform: translateY(0); } 50% { transform: translateY(-12px); } 100% { transform: translateY(0); } }
        
        .loading-overlay { position: absolute; top:0; left:0; width:100%; height:100%; background:rgba(11,12,21,0.95); z-index: 2000; display:flex; justify-content:center; align-items:center; flex-direction:column;}
        .spinner { width: 50px; height: 50px; border: 5px solid rgba(255,255,255,0.1); border-top: 5px solid var(--accent); border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 20px;}
        .loading-text { font-size: 18px; font-weight: 600; color: white; letter-spacing: 1px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="app-container">
    
    <div id="loadingScreen" class="loading-overlay">
        <div class="spinner"></div>
        <div class="loading-text">Starting SkyCast...</div>
    </div>

    <div class="sticky-header">
        <div class="search-bar">
            <i class="fa-solid fa-location-crosshairs" style="color: var(--accent); margin-right:10px; font-size: 18px; cursor:pointer;" onclick="askLocation()" title="Get Current Location"></i>
            <input type="text" id="cityInput" placeholder="Search City..." onkeyup="handleTyping()">
            <button class="search-btn" onclick="searchByInput()"><i class="fa-solid fa-arrow-right"></i></button>
        </div>
        <ul id="suggestions" class="suggestions-list"></ul>
        <div id="errorMsg" style="color: #ff6b6b; text-align: center; display: none; margin-top: 10px; font-size: 14px;"></div>
    </div>

    <div class="content-area">
        
        <div class="main-card">
            <div class="weather-text">
                <h2 id="cityName">--</h2>
                <h1 id="temp">--°</h1>
                <p id="condition">Loading...</p>
                <p id="realFeel" class="feels-like">Feels like --°</p>
            </div>
            <img id="mainIcon" src="" class="weather-3d-icon" style="display: none;"> 
        </div>

        <div class="ad-slot"><span>Google Ads Here</span></div>

        <div class="details-grid">
            <div class="detail-box"><i class="fa-solid fa-droplet"></i><span id="humidity">--%</span><small>Humidity</small></div>
            <div class="detail-box"><i class="fa-solid fa-wind"></i><span id="wind">-- km/h</span><small>Wind</small></div>
            <div class="detail-box"><i class="fa-solid fa-sun"></i><span id="uvIndex">--</span><small>UV Index</small></div>
        </div>

        <h3 style="font-size: 18px; margin-bottom: 15px; margin-top: 10px;">5-Day Forecast</h3>
        <div id="dailyList"></div>

        <div class="ad-slot" style="margin-top: 30px;"><span>Google Ads Here</span></div>
        
        <footer class="app-footer">
            <p>Developed by <b>Ankit Chaurasia</b></p>
            <div class="footer-links">
                <span>Privacy Policy</span> • <span>Terms of Service</span> • <span>Contact</span>
            </div>
        </footer>

    </div>
</div>

<script>
    // ---------------------------------------------------------
    // ⚠️ PASTE YOUR ACCUWEATHER API KEY HERE
    // ---------------------------------------------------------
    const apiKey = "zpka_c2397319d16041c39ba01d0dc2deb78c_695c8125"; 
    // ---------------------------------------------------------

    const cityInput = document.getElementById("cityInput");
    const suggestionsList = document.getElementById("suggestions");
    const errorMsg = document.getElementById("errorMsg");
    const mainIcon = document.getElementById("mainIcon");
    const loadingScreen = document.getElementById("loadingScreen");
    let debounceTimer; 

    window.addEventListener('load', () => { askLocation(); });

    function askLocation() {
        loadingScreen.style.display = 'flex';
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                (position) => { getCityFromLatLon(position.coords.latitude, position.coords.longitude); },
                (error) => { 
                    loadingScreen.style.display = 'none';
                    getWeatherByKey("202396", "New Delhi"); 
                }
            );
        } else {
            loadingScreen.style.display = 'none';
            getWeatherByKey("202396", "New Delhi");
        }
    }

    async function getCityFromLatLon(lat, lon) {
        const url = `https://dataservice.accuweather.com/locations/v1/cities/geoposition/search?apikey=${apiKey}&q=${lat},${lon}`;
        try {
            const res = await fetch(url);
            const data = await res.json();
            if(data && data.Key) {
                getWeatherByKey(data.Key, data.EnglishName);
            } else { throw new Error("Location not found"); }
        } catch (err) {
            loadingScreen.style.display = 'none';
            getWeatherByKey("202396", "New Delhi"); 
        }
    }

    async function getWeatherByKey(locationKey, cityName) {
        errorMsg.style.display = "none";
        suggestionsList.style.display = 'none';
        
        document.getElementById("cityName").innerText = cityName;
        cityInput.value = cityName;

        try {
            const currentUrl = `https://dataservice.accuweather.com/currentconditions/v1/${locationKey}?apikey=${apiKey}&details=true`;
            const currentRes = await fetch(currentUrl);
            const currentData = await currentRes.json();
            const current = currentData[0];

            document.getElementById("temp").innerText = Math.round(current.Temperature.Metric.Value) + "°";
            document.getElementById("condition").innerText = current.WeatherText;
            
            if (current.RealFeelTemperature) {
                document.getElementById("realFeel").innerText = "Feels like " + Math.round(current.RealFeelTemperature.Metric.Value) + "°";
            } else { document.getElementById("realFeel").innerText = ""; }

            document.getElementById("humidity").innerText = current.RelativeHumidity + "%";
            document.getElementById("wind").innerText = Math.round(current.Wind.Speed.Metric.Value) + " km/h";
            document.getElementById("uvIndex").innerText = current.UVIndexText;
            mainIcon.src = getCustomIcon(current.WeatherIcon);
            mainIcon.style.display = "block";
            
            loadingScreen.style.display = 'none'; 

            const forecastUrl = `https://dataservice.accuweather.com/forecasts/v1/daily/5day/${locationKey}?apikey=${apiKey}&metric=true`;
            const forecastRes = await fetch(forecastUrl);
            const forecastData = await forecastRes.json();
            const dailyList = document.getElementById("dailyList");
            dailyList.innerHTML = ""; 

            forecastData.DailyForecasts.forEach(day => {
                const date = new Date(day.Date);
                const dayName = date.toLocaleDateString('en-US', { weekday: 'long' });
                const iconUrl = getCustomIcon(day.Day.Icon);
                dailyList.innerHTML += `
                    <div class="daily-row">
                        <div class="daily-left"><img src="${iconUrl}" class="daily-icon">
                            <div><div class="day-name">${dayName}</div><div class="day-phrase">${day.Day.IconPhrase}</div></div>
                        </div>
                        <div class="day-temp">${Math.round(day.Temperature.Maximum.Value)}° / <span style="color:#777">${Math.round(day.Temperature.Minimum.Value)}°</span></div>
                    </div>`;
            });

        } catch (error) {
            loadingScreen.style.display = 'none';
            errorMsg.innerText = "Error: Check API Key or Limit.";
            errorMsg.style.display = "block";
        }
    }

    function searchByInput() {
        const query = cityInput.value;
        if(query) getAccuWeatherByName(query);
    }

    async function getAccuWeatherByName(query) {
        const searchUrl = `https://dataservice.accuweather.com/locations/v1/cities/search?apikey=${apiKey}&q=${query}`;
        try {
            const res = await fetch(searchUrl);
            const data = await res.json();
            if (data.length > 0) {
                getWeatherByKey(data[0].Key, data[0].EnglishName);
            } else {
                errorMsg.innerText = "City not found!";
                errorMsg.style.display = "block";
            }
        } catch(e) {}
    }

    function handleTyping() {
        const query = cityInput.value;
        if (query.length < 3) { suggestionsList.style.display = 'none'; return; }
        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(() => fetchSuggestions(query), 500);
    }

    async function fetchSuggestions(query) {
        const url = `https://dataservice.accuweather.com/locations/v1/cities/autocomplete?apikey=${apiKey}&q=${query}`;
        try {
            const res = await fetch(url);
            const data = await res.json();
            suggestionsList.innerHTML = "";
            if (data.length > 0) {
                suggestionsList.style.display = 'block';
                data.forEach(city => {
                    const li = document.createElement('li');
                    li.innerHTML = `<span>${city.LocalizedName}</span> <small>${city.Country.ID}</small>`;
                    li.onclick = () => { getWeatherByKey(city.Key, city.LocalizedName); };
                    suggestionsList.appendChild(li);
                });
            } else { suggestionsList.style.display = 'none'; }
        } catch (err) {}
    }

    function getCustomIcon(iconId) {
        const id = Number(iconId);
        const baseUrl = "https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Travel%20and%20places/";
        if ([1, 2, 3, 4, 5, 30].includes(id)) return baseUrl + "Sun.png";
        if ([6, 7, 8, 11, 31, 32].includes(id)) return baseUrl + "Cloud.png";
        if (id === 11) return baseUrl + "Fog.png";
        if ([12, 13, 14, 18, 26, 29, 39, 40].includes(id)) return baseUrl + "Cloud%20with%20Rain.png";
        if ([15, 16, 17, 41, 42].includes(id)) return baseUrl + "Cloud%20with%20Lightning%20and%20Rain.png";
        if ([19, 20, 21, 22, 23, 24, 25, 43, 44].includes(id)) return baseUrl + "Snowman.png";
        if ([33, 34].includes(id)) return baseUrl + "Crescent%20Moon.png";
        if ([35, 36, 37, 38].includes(id)) return baseUrl + "Cloud.png";
        return baseUrl + "Sun%20Behind%20Cloud.png";
    }

    document.addEventListener('click', function(e) {
        if (!cityInput.contains(e.target) && !suggestionsList.contains(e.target)) {
            suggestionsList.style.display = 'none';
        }
    });
</script>

</body>
</html>
